---
import { Picture } from "astro:assets";
import AppwriteIcon from "components/icons/AppwriteIcon.astro";
import GithubAltIcon from "components/icons/GithubAltIcon.astro";
import JavaSpringIcon from "components/icons/JavaSpringIcon.astro";
import LinkIcon from "components/icons/LinkIcon.astro";
import ReactIcon from "components/icons/ReactIcon.astro";
import ShadcnIcon from "components/icons/ShadcnIcon.astro";
import TailwindIcon from "components/icons/TailwindIcon.astro";
import TypeScriptIcon from "components/icons/TypeScriptIcon.astro";
import { useTranslations } from "i18n/utils";
import type { Params, Projects } from "pages/[...lang].astro";
import { TECHNOLOGIES } from "values/technologies";

type Props = {
  projects: Projects;
};

const { lang } = Astro.params as Params;
const { projects } = Astro.props;
if (!projects) {
  throw new Error("No projects data");
}

const t = useTranslations(lang);
---

<main id="projects" class="mx-auto w-full max-w-3xl scroll-mt-20">
  <h3
    class="text-3xl font-bold mt-16 mb-8 max-w-3xl mx-auto dark:text-amber-200 text-amber-500 text-center md:text-left"
  >
    {t("projects.h3")}
  </h3>
  <ul class="flex flex-col gap-y-8 mt-2">
    {
      projects.map(({ data: project }, index) => (
        <li
          class={`group border rounded-lg transition-all p-6 border-yellow-300 dark:border-yellow-900 md:hover:border-orange-500 md:dark:hover:border-orange-500 shadow-md md:hover:shadow-2xl md:hover:shadow-orange-500/20 md:cursor-pointer md:hover:scale-[1.02] animate-fade-in-up animate-delay-${index * 100}`}
        >
          <section class="flex flex-col md:flex-row gap-x-8 gap-y-4 w-full">
            <div class="flex flex-col basis-1/2 gap-y-2 items-center justify-between w-full">
              <div>
                <h4 class="text-xl font-bold dark:text-amber-200 text-amber-500 group-hover:text-orange-500 dark:group-hover:text-orange-400 transition-colors">
                  {project.name}
                </h4>
                <ul class="list-none py-2 text-pretty text-base dark:text-amber-50 text-amber-950">
                  {project.description
                    .split(".")
                    .map((sentence, index, array) => (
                      <span>
                        {index !== array.length - 1 ? (
                          <li class="py-1">âœ” {sentence}.</li>
                        ) : (
                          sentence
                        )}
                      </span>
                    ))}
                </ul>
              </div>
              <div class="flex gap-4 justify-center items-center">
                <a
                  href={project.github}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="flex flex-col justify-center items-center gap-1 px-4 py-2 rounded-lg
                  bg-gray-100 dark:bg-gray-950
                  text-gray-700 dark:text-gray-300
                  hover:bg-amber-700 hover:text-white
                  dark:hover:bg-amber-600 dark:hover:text-white
                  transition-all duration-300 hover:scale-110 hover:shadow-lg"
                >
                  <GithubAltIcon class="size-6" />
                  <span class="text-xs font-medium">Source</span>
                </a>
                <a
                  href={project.demo}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="flex flex-col justify-center items-center gap-1 px-4 py-2 rounded-lg
                  bg-gray-100 dark:bg-gray-900
                  text-gray-700 dark:text-gray-300
                  hover:bg-sky-700 hover:text-white
                  dark:hover:bg-sky-600 dark:hover:text-white
                  transition-all duration-300 hover:scale-110 hover:shadow-lg"
                >
                  <LinkIcon class="size-6" />
                  <span class="text-xs font-medium">Demo</span>
                </a>
              </div>
            </div>
            <div class="flex flex-col gap-2 flex-1 basis-1/2 w-full items-start justify-around">
              <div class="relative group/image overflow-hidden rounded-lg">
                <Picture
                  src={project.cover}
                  format={project.cover.format}
                  width="500"
                  height="350"
                  alt={project.imageAlt}
                  class="rounded-md transition-transform duration-500 group-hover:scale-110"
                />
                <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300" />
              </div>
              <ul class="flex items-center justify-center gap-3 group flex-wrap md:flex-nowrap w-full text-xs dark:text-amber-50 text-amber-950">
                {project.tech.map((t) => {
                  switch (t) {
                    case TECHNOLOGIES.Typescript:
                      return (
                        <li
                          class="flex flex-col items-center justify-center"
                          title={t}
                        >
                          <TypeScriptIcon class="size-8 md:group-hover:animate-squeeze md:group-hover:animate-duration-1000" />
                          <span>{t}</span>
                        </li>
                      );
                    case TECHNOLOGIES.React:
                      return (
                        <li
                          class="flex flex-col items-center justify-center"
                          title={t}
                        >
                          <ReactIcon class="size-8 md:group-hover:animate-spin-clockwise md:group-hover:animate-duration-1000" />
                          <span>{t}</span>
                        </li>
                      );
                    case TECHNOLOGIES.Appwrite:
                      return (
                        <li
                          class="flex flex-col items-center justify-center"
                          title={t}
                        >
                          <AppwriteIcon class="size-8 md:group-hover:animate-tada md:group-hover:animate-duration-1000" />
                          <span>{t}</span>
                        </li>
                      );
                    case TECHNOLOGIES.TailwindCSS:
                      return (
                        <li
                          class="flex flex-col items-center justify-center"
                          title={t}
                        >
                          <TailwindIcon class="size-8 md:group-hover:animate-dancing md:group-hover:animate-duration-1000" />
                          <span>{t}</span>
                        </li>
                      );
                    case TECHNOLOGIES.ShadCN:
                      return (
                        <li
                          class="flex flex-col items-center justify-center"
                          title={t}
                        >
                          <ShadcnIcon
                            class={
                              "size-8 md:group-hover:animate-pulse-fade-in md:group-hover:animate-duration-1000"
                            }
                          />
                          <span>{t}</span>
                        </li>
                      );
                    case TECHNOLOGIES.JavaSpring:
                      return (
                        <li
                          class="
                          flex flex-col items-center justify-center"
                          title={t}
                        >
                          <JavaSpringIcon
                            class={
                              "size-8 md:group-hover:animate-swing-drop-in md:group-hover:animate-duration-1000"
                            }
                          />
                          <span>{t}</span>
                        </li>
                      );
                    default:
                      return null;
                  }
                })}
              </ul>
            </div>
          </section>
        </li>
      ))
    }
  </ul>
</main>
